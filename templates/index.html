<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scholarship Eligibility Filter</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .user-menu { display: flex; align-items: center; gap: 15px; }
        .user-avatar { width: 40px; height: 40px; border-radius: 50%; border: 2px solid #4f46e5; }
        .user-info { display: flex; align-items: center; gap: 10px; color: rgb(10, 9, 9); }
        .login-btn, .logout-btn { padding: 8px 20px; border-radius: 20px; font-weight: 500; text-decoration: none; transition: all 0.3s ease; }
        .login-btn { background: #4f46e5; color: white; }
        .login-btn:hover { background: #4338ca; transform: translateY(-2px); }
        .logout-btn { background: #fee2e2; border: 1px solid #fca5a5; color: #dc2626; font-size: 0.85rem; }
        .logout-btn:hover { background: #fecaca; }
        .login-prompt { background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 16px; padding: 40px; text-align: center; color: white; margin: 40px auto; max-width: 500px; }
        .login-prompt h3 { margin-bottom: 15px; font-size: 1.5rem; }
        .login-prompt p { opacity: 0.9; margin-bottom: 25px; }
        .google-btn { display: inline-flex; align-items: center; gap: 12px; padding: 14px 30px; background: white; border-radius: 30px; font-weight: 600; color: #333; text-decoration: none; transition: all 0.3s ease; }
        .google-btn:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .welcome-banner { background: linear-gradient(135deg, #10b981, #059669); border-radius: 12px; padding: 20px 30px; margin-bottom: 30px; display: flex; align-items: center; justify-content: space-between; color: white; flex-wrap: wrap; gap: 15px; }
        .welcome-banner .user-details { display: flex; align-items: center; gap: 15px; }
        .welcome-banner .user-details img { width: 50px; height: 50px; border-radius: 50%; border: 3px solid rgba(255,255,255,0.3); }
        .welcome-banner .default-avatar { width: 50px; height: 50px; border-radius: 50%; background: rgba(255,255,255,0.2); display: flex; align-items: center; justify-content: center; font-size: 1.5rem; }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-brand">
            <span class="logo">üéì</span>
            <h1>Scholarship Eligibility Filter</h1>
        </div>
        <ul class="nav-links">
            {% if logged_in %}
            <!-- Student Navigation -->
            <li><a href="/" class="active">Apply</a></li>
            <li><a href="{{ url_for('my_applications') }}">My Applications</a></li>
            <li><a href="/dashboard">Dashboard</a></li>
            {% else %}
            <!-- Public Navigation -->
            <li><a href="/" class="active">Home</a></li>
            <li><a href="/dashboard">Dashboard</a></li>
            <li><a href="/admin/login">Admin Login</a></li>
            {% endif %}
        </ul>
        <div class="user-menu">
            {% if logged_in %}
            <div class="user-info">
                {% if session.student_picture %}
                <img src="{{ session.student_picture }}" alt="Profile" class="user-avatar">
                {% else %}
                <span class="user-avatar" style="background: #4f46e5; display: flex; align-items: center; justify-content: center; color: white;">üë§</span>
                {% endif %}
                <span>{{ session.student_name }}</span>
            </div>
            <a href="{{ url_for('student_logout') }}" class="logout-btn">Logout</a>
            {% else %}
            <a href="{{ url_for('student_login') }}" class="login-btn">üîê Student Login</a>
            {% endif %}
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container">
        <!-- Hero Section -->
        <section class="hero">
            <h2>Check Your Scholarship Eligibility</h2>
            <p>Fill in your details below to check which scholarships you qualify for</p>
        </section>

        {% if not logged_in %}
        <!-- Login Prompt -->
        <section class="login-prompt">
            <h3>üîê Login Required</h3>
            <p>Please sign in with your Google account to check eligibility and apply for scholarships</p>
            <a href="{{ url_for('student_login') }}" class="google-btn">
                <svg width="24" height="24" viewBox="0 0 24 24">
                    <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/>
                    <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
                    <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/>
                    <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
                </svg>
                Sign in with Google
            </a>
        </section>
        {% else %}
        
        <!-- Welcome Banner -->
        <section class="welcome-banner">
            <div class="user-details">
                {% if session.student_picture %}
                <img src="{{ session.student_picture }}" alt="Profile">
                {% else %}
                <div class="default-avatar">üë§</div>
                {% endif %}
                <div>
                    <h4 style="margin: 0;">Welcome, {{ session.student_name }}!</h4>
                    <small style="opacity: 0.8;">{{ session.student_email }}</small>
                </div>
            </div>
            <a href="{{ url_for('my_applications') }}" style="background: rgba(255,255,255,0.2); color: white; padding: 10px 20px; border-radius: 8px; text-decoration: none;">üìã My Applications</a>
        </section>

        <!-- Application Form -->
        <section class="form-section">
            <div class="form-card">
                <h3>{{ 'Update Your Profile' if student and student.is_registered else 'Complete Your Profile' }}</h3>
                
                <form id="applicationForm">
                    <!-- Personal Details -->
                    <div class="form-group">
                        <label for="name">Full Name *</label>
                        <input type="text" id="name" name="name" placeholder="Enter your full name" value="{{ student.name if student else '' }}" required>
                    </div>

                    <div class="form-group">
                        <label for="email">Email Address *</label>
                        <input type="email" id="email" name="email" value="{{ session.student_email }}" readonly style="background: #f3f4f6;">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="course">Course / Program *</label>
                            <select id="course" name="course" required>
                                <option value="">Select Course</option>
                                <option value="B.Tech" {{ 'selected' if student and student.course == 'B.Tech' }}>B.Tech</option>
                                <option value="B.E." {{ 'selected' if student and student.course == 'B.E.' }}>B.E.</option>
                                <option value="B.Sc" {{ 'selected' if student and student.course == 'B.Sc' }}>B.Sc</option>
                                <option value="B.Com">B.Com</option>
                                <option value="B.A.">B.A.</option>
                                <option value="BBA">BBA</option>
                                <option value="BCA">BCA</option>
                                <option value="M.Tech">M.Tech</option>
                                <option value="M.Sc">M.Sc</option>
                                <option value="MBA">MBA</option>
                                <option value="MCA">MCA</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="year_of_study">Year of Study *</label>
                            <select id="year_of_study" name="year_of_study" required>
                                <option value="">Select Year</option>
                                <option value="1">1st Year</option>
                                <option value="2">2nd Year</option>
                                <option value="3">3rd Year</option>
                                <option value="4">4th Year</option>
                                <option value="5">5th Year</option>
                            </select>
                        </div>
                    </div>

                    <!-- Academic Details -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="marks_percentage">Marks / CGPA (in %) *</label>
                            <input type="number" id="marks_percentage" name="marks_percentage" 
                                   placeholder="Enter percentage (0-100)" min="0" max="100" step="0.01" required>
                            <small>If CGPA, convert to percentage (e.g., CGPA 8.5 = 85%)</small>
                        </div>

                        <div class="form-group">
                            <label for="family_income">Annual Family Income (‚Çπ) *</label>
                            <input type="number" id="family_income" name="family_income" 
                                   placeholder="Enter annual income" min="0" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="category">Category *</label>
                        <select id="category" name="category" required>
                            <option value="">Select Category</option>
                            <option value="General">General</option>
                            <option value="OBC">OBC (Other Backward Class)</option>
                            <option value="SC">SC (Scheduled Caste)</option>
                            <option value="ST">ST (Scheduled Tribe)</option>
                            <option value="EWS">EWS (Economically Weaker Section)</option>
                        </select>
                    </div>

                    <!-- Yes/No Questions -->
                    <div class="form-row checkbox-row">
                        <div class="form-group checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="has_backlogs" name="has_backlogs">
                                <span class="checkmark"></span>
                                Do you have any active backlogs?
                            </label>
                        </div>

                        <div class="form-group checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="is_full_time" name="is_full_time" checked>
                                <span class="checkmark"></span>
                                Are you a full-time student?
                            </label>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <button type="submit" class="btn btn-primary" id="submitBtn">
                        <span class="btn-text">Check Eligibility</span>
                        <span class="btn-loader" style="display: none;">Processing...</span>
                    </button>
                </form>
            </div>
        </section>
        {% endif %}

        <!-- Available Scholarships Preview -->
        <section class="scholarships-preview">
            <h3>Available Scholarships</h3>
            <div id="scholarshipsList" class="scholarships-grid">
                <!-- Scholarships will be loaded dynamically -->
                <div class="loading">Loading scholarships...</div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <p>¬© 2024 Scholarship Eligibility Filter | Built with ‚ù§Ô∏è for Education</p>
    </footer>

    <!-- JavaScript -->
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
